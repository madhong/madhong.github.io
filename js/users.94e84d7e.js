(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["users"],{"7e49":function(e,t,s){},c562:function(e,t,s){"use strict";var r=s("7e49"),a=s.n(r);a.a},dbef:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"users"},[s("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[s("el-breadcrumb-item",{attrs:{to:{path:"/welcome"}}},[e._v("首页")]),s("el-breadcrumb-item",[e._v("用户管理")]),s("el-breadcrumb-item",[e._v("用户列表")])],1),s("el-input",{staticClass:"input-with-select search",attrs:{placeholder:"请输入内容"},model:{value:e.query,callback:function(t){e.query=t},expression:"query"}},[s("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.searchName},slot:"append"})],1),s("el-button",{attrs:{type:"success",plain:""},on:{click:e.showAddVisible}},[e._v("添加用户")]),[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[s("el-table-column",{attrs:{prop:"username",label:"姓名",width:"180"}}),s("el-table-column",{attrs:{prop:"email",label:"邮箱",width:"180"}}),s("el-table-column",{attrs:{prop:"mobile",label:"电话"}}),s("el-table-column",{attrs:{prop:"mg_state",label:"用户状态"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[s("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(t){return e.status(r)}},model:{value:r.mg_state,callback:function(t){e.$set(r,"mg_state",t)},expression:"row.mg_state"}})]}}])}),s("el-table-column",{attrs:{prop:"address",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[s("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-edit",plain:""},on:{click:function(t){return e.showAlterUser(r)}}}),s("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete",plain:""},on:{click:function(t){return e.delUser(r)}}}),s("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-check",plain:""},on:{click:function(t){return e.showAssginUser(r)}}},[e._v("分配角色")])]}}])})],1)],s("el-pagination",{attrs:{"current-page":e.pagenum,"page-sizes":[2,4,6,8,10],"page-size":2,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),s("el-dialog",{attrs:{title:"修改用户",visible:e.alterVisible,width:"40%"},on:{"update:visible":function(t){e.alterVisible=t}}},[s("el-form",{ref:"deitForm",attrs:{rules:e.rules,model:e.editForm,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"用户名"}},[s("el-tag",{attrs:{type:"info"}},[e._v(e._s(e.editForm.username))])],1),s("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[s("el-input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.editForm.email,callback:function(t){e.$set(e.editForm,"email",t)},expression:"editForm.email"}})],1),s("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[s("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.editForm.mobile,callback:function(t){e.$set(e.editForm,"mobile",t)},expression:"editForm.mobile"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.alterVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.alterUser}},[e._v("确 定")])],1)],1),s("el-dialog",{attrs:{title:"分配角色",visible:e.assginVisible,width:"40%"},on:{"update:visible":function(t){e.assginVisible=t}}},[s("el-form",{ref:"assForm",attrs:{model:e.assForm,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"用户名"}},[s("el-tag",{attrs:{type:"info"}},[e._v(e._s(e.assForm.username))])],1),s("el-form-item",{attrs:{label:"角色列表"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.assForm.rid,callback:function(t){e.$set(e.assForm,"rid",t)},expression:"assForm.rid"}},e._l(e.roleList,function(e){return s("el-option",{key:e.id,attrs:{label:e.roleName,value:e.id}})}),1)],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.assginVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.assUser}},[e._v("确 定")])],1)],1),s("el-dialog",{attrs:{title:"添加用户",visible:e.addVisible,width:"40%"},on:{"update:visible":function(t){e.addVisible=t}}},[s("el-form",{ref:"addForm",attrs:{"status-icon":"",rules:e.rules,model:e.addForm,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"用户名",prop:"username"}},[s("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.addForm.username,callback:function(t){e.$set(e.addForm,"username",t)},expression:"addForm.username"}})],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.addForm.password,callback:function(t){e.$set(e.addForm,"password",t)},expression:"addForm.password"}})],1),s("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[s("el-input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.addForm.email,callback:function(t){e.$set(e.addForm,"email",t)},expression:"addForm.email"}})],1),s("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[s("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.addForm.mobile,callback:function(t){e.$set(e.addForm,"mobile",t)},expression:"addForm.mobile"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.readdVisible}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[e._v("确 定")])],1)],1)],2)},a=[],i=(s("96cf"),s("3b8d")),n={created:function(){this.getUserList()},data:function(){return{value:!0,tableData:[],query:"",pagenum:1,pagesize:2,total:0,alterVisible:!1,editForm:{id:"",username:"",email:"",mobile:""},rules:{username:[{required:!0,message:"请输入用户名",trigger:["blur","change"]},{min:4,max:16,message:"长度在 4 到 16 个字符",trigger:["blur","change"]}],password:[{required:!0,message:"请输入密码",trigger:["blur","change"]},{min:6,max:12,message:"长度在 6 到 12 个字符",trigger:["blur","change"]}],email:[{type:"email",message:"请输入正确的邮箱",trigger:["blur","change"]}],mobile:[{pattern:/^1[3-9]\d{9}$/,message:"请输入正确得手机号",trigger:["blur","change"]}]},assginVisible:!1,assForm:{id:"",username:"",rid:""},roleValue:"",roleList:[],addVisible:!1,addForm:{username:"",password:"",email:"",mobile:""}}},methods:{getUserList:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,s,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$axios.get("users",{params:{query:this.query,pagenum:this.pagenum,pagesize:this.pagesize}});case 2:t=e.sent,s=t.data,r=t.meta,200===r.status&&(this.tableData=s.users,this.total=s.total);case 6:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),handleSizeChange:function(e){this.pagesize=e,this.pagenum=1,this.getUserList()},handleCurrentChange:function(e){this.pagenum=e,this.getUserList()},delUser:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){var s,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$confirm("你还真敢删啊？","温馨提示",{type:"warning"});case 3:return e.next=5,this.$axios.delete("users/".concat(t.id));case 5:s=e.sent,r=s.meta,200===r.status?(this.$message.success(r.msg),1===this.tableData.length&&this.pagenum>1&&this.pagenum--,this.getUserList()):this.$message.error(r.msg),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](0),console.log(e.t0),this.$message("取消成功");case 14:case"end":return e.stop()}},e,this,[[0,10]])}));function t(t){return e.apply(this,arguments)}return t}(),searchName:function(){this.pagenum=1,this.getUserList()},showAlterUser:function(e){this.alterVisible=!0,this.editForm.username=e.username,this.editForm.email=e.email,this.editForm.mobile=e.mobile,this.editForm.id=e.id},alterUser:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,s,r,a,i,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$refs.deitForm.validate();case 3:return t=this.editForm,s=t.id,r=t.email,a=t.mobile,e.next=6,this.$axios.put("users/".concat(s),{email:r,mobile:a});case 6:i=e.sent,n=i.meta,200===n.status?(this.$message.success(n.msg),this.alterVisible=!1,this.getUserList()):this.$message.error(n.msg),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),console.log(e.t0);case 14:case"end":return e.stop()}},e,this,[[0,11]])}));function t(){return e.apply(this,arguments)}return t}(),showAssginUser:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){var s,r,a,i,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.assginVisible=!0,this.assForm.id=t.id,this.assForm.username=t.username,e.next=5,this.$axios.get("/users/".concat(t.id));case 5:return s=e.sent,200===s.meta.status&&(r=s.data.rid,this.assForm.rid=-1===r?"":r),e.next=9,this.$axios.get("roles");case 9:a=e.sent,i=a.data,n=a.meta,200===n.status?this.roleList=i:this.$message.success(n.msg);case 13:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),assUser:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$axios.put("users/".concat(this.assForm.id,"/role"),{rid:this.assForm.rid});case 2:t=e.sent,s=t.meta,200===s.status?(this.$message.success(s.msg),this.assginVisible=!1):this.$message.error(s.msg);case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),showAddVisible:function(){this.addVisible=!0},readdVisible:function(){this.addVisible=!1,this.$refs.addForm.resetFields()},addUser:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,s,r,a,i,n,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$refs.addForm.validate();case 3:return t=this.addForm,s=t.username,r=t.password,a=t.email,i=t.mobile,e.next=6,this.$axios.post("users",{username:s,password:r,email:a,mobile:i});case 6:n=e.sent,o=n.meta,201===o.status?(this.$message.success(o.msg),this.addVisible=!1,this.$refs.addForm.resetFields()):this.$message.error(o.msg),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),console.log(e.t0);case 14:case"end":return e.stop()}},e,this,[[0,11]])}));function t(){return e.apply(this,arguments)}return t}(),status:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){var s,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$axios.put("users/".concat(t.id,"/state/").concat(t.mg_state));case 2:s=e.sent,r=s.meta,200===r.status?this.$message.success(r.msg):this.$message.error(r.msg);case 5:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()}},o=n,l=(s("c562"),s("2877")),c=Object(l["a"])(o,r,a,!1,null,"48cf28b9",null);t["default"]=c.exports}}]);
//# sourceMappingURL=users.94e84d7e.js.map